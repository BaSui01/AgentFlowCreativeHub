# ğŸ—ï¸ æ¶æ„è®¾è®¡æ–‡æ¡£

> **ç‰ˆæœ¬**: v2.0  
> **æ›´æ–°æ—¥æœŸ**: 2025-11-17  
> **æ¶æ„**: çº¯ Go å•ä½“åº”ç”¨

---

## ğŸ“‹ ç›®å½•

- [1. æ¶æ„ç›®æ ‡ä¸çº¦æŸ](#1-æ¶æ„ç›®æ ‡ä¸çº¦æŸ)
- [2. ç³»ç»Ÿæ¶æ„è®¾è®¡](#2-ç³»ç»Ÿæ¶æ„è®¾è®¡)
- [3. æ¨¡å—è®¾è®¡](#3-æ¨¡å—è®¾è®¡)
- [4. æ•°æ®å­˜å‚¨æ¶æ„](#4-æ•°æ®å­˜å‚¨æ¶æ„)
- [5. å¤šç§Ÿæˆ·æ–¹æ¡ˆ](#5-å¤šç§Ÿæˆ·æ–¹æ¡ˆ)
- [6. å®‰å…¨ä¸æƒé™è®¾è®¡](#6-å®‰å…¨ä¸æƒé™è®¾è®¡)
- [7. éƒ¨ç½²ä¸è¿ç»´](#7-éƒ¨ç½²ä¸è¿ç»´)
- [8. æ‰©å±•æ€§ä¸æ¼”åŒ–è·¯å¾„](#8-æ‰©å±•æ€§ä¸æ¼”åŒ–è·¯å¾„)
- [9. é£é™©ä¸æŒ‘æˆ˜](#9-é£é™©ä¸æŒ‘æˆ˜)

---

## 1. æ¶æ„ç›®æ ‡ä¸çº¦æŸ

### 1.1 æ¶æ„ç›®æ ‡

- **ğŸ¯ ç®€æ´æ€§**: è½»é‡çº§æŠ€æœ¯æ ˆ,å‡å°‘æ¶æ„å¤æ‚åº¦
- **ğŸš€ é«˜æ€§èƒ½**: æ”¯æŒé«˜å¹¶å‘,ä½å»¶è¿Ÿå“åº”
- **ğŸ“¦ æ˜“éƒ¨ç½²**: å•ä¸€äºŒè¿›åˆ¶,ç®€åŒ–éƒ¨ç½²æµç¨‹
- **ğŸ”§ å¯ç»´æŠ¤**: ç»Ÿä¸€æŠ€æœ¯æ ˆ,é™ä½ç»´æŠ¤æˆæœ¬
- **ğŸ”„ å¯æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡,æ”¯æŒæ°´å¹³æ‰©å±•

### 1.2 æ¶æ„çº¦æŸ

- **èµ„æºçº¦æŸ**: åˆæœŸå•æœåŠ¡å™¨éƒ¨ç½²,èµ„æºæœ‰é™
- **æ—¶é—´çº¦æŸ**: å¿«é€ŸéªŒè¯ MVP,ä¼˜å…ˆæ ¸å¿ƒåŠŸèƒ½
- **æŠ€æœ¯çº¦æŸ**: çº¯ Go å®ç°,é¿å…å¤šè¯­è¨€æ··åˆ
- **æˆæœ¬çº¦æŸ**: æ§åˆ¶åŸºç¡€è®¾æ–½æˆæœ¬

### 1.3 éåŠŸèƒ½éœ€æ±‚

| éœ€æ±‚ç±»å‹ | æŒ‡æ ‡ | è¯´æ˜ |
|---------|------|------|
| **æ€§èƒ½** | QPS > 1000 | å•æœºæ”¯æŒ 1000+ å¹¶å‘è¯·æ±‚ |
| **å¯ç”¨æ€§** | 99.9% | å¹´åœæœºæ—¶é—´ < 8.76 å°æ—¶ |
| **æ‰©å±•æ€§** | æ°´å¹³æ‰©å±• | æ”¯æŒå¤šå®ä¾‹è´Ÿè½½å‡è¡¡ |
| **å®‰å…¨æ€§** | HTTPS + JWT | æ•°æ®ä¼ è¾“åŠ å¯†,è®¤è¯æˆæƒ |
| **å¯ç»´æŠ¤æ€§** | ä»£ç è§„èŒƒ | ç»Ÿä¸€ç¼–ç è§„èŒƒ,å®Œå–„æ–‡æ¡£ |

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       å®¢æˆ·ç«¯å±‚                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ Web å‰ç«¯  â”‚  â”‚ ç§»åŠ¨ç«¯    â”‚  â”‚ API å®¢æˆ·ç«¯â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚             â”‚             â”‚
          â”‚     HTTPS / REST API      â”‚
          â”‚             â”‚             â”‚
          â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨æœåŠ¡å±‚ (Go)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          Gin Web æ¡†æ¶ + ä¸­é—´ä»¶                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ è®¤è¯ä¸­é—´ä»¶ â”‚ æ—¥å¿—ä¸­é—´ä»¶ â”‚ é™æµä¸­é—´ä»¶ â”‚ CORSä¸­é—´ä»¶â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   ä¸šåŠ¡æ¨¡å—å±‚                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ ç§Ÿæˆ·ç®¡ç† â”‚ ç”¨æˆ·ç®¡ç† â”‚ æ¨¡å‹ç®¡ç† â”‚ æ¨¡æ¿ç®¡ç†    â”‚   â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â”‚
â”‚  â”‚  â”‚ Agent   â”‚ å·¥ä½œæµ   â”‚ RAG     â”‚ å®¡è®¡æ—¥å¿—    â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 åŸºç¡€è®¾æ–½å±‚                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ æ•°æ®åº“è¿æ¥â”‚ Redisè¿æ¥ â”‚ æ—¥å¿—ç³»ç»Ÿ â”‚ é…ç½®ç®¡ç† â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®å­˜å‚¨å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   PostgreSQL     â”‚      â”‚      Redis       â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚
â”‚  â”‚  â”‚ ä¸šåŠ¡æ•°æ®    â”‚  â”‚      â”‚  â”‚ ç¼“å­˜        â”‚ â”‚        â”‚
â”‚  â”‚  â”‚ pgvector   â”‚  â”‚      â”‚  â”‚ ä¼šè¯        â”‚ â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ ¸å¿ƒæ¶æ„å†³ç­–

#### å†³ç­– 1: çº¯ Go å•ä½“åº”ç”¨

**é€‰æ‹©**: çº¯ Go å®ç°,å•ä½“åº”ç”¨æ¶æ„

**ç†ç”±**:
- âœ… å¿«é€Ÿè¿­ä»£,ç®€åŒ–å¼€å‘å’Œéƒ¨ç½²
- âœ… ç»Ÿä¸€æŠ€æœ¯æ ˆ,é™ä½ç»´æŠ¤æˆæœ¬
- âœ… é«˜æ€§èƒ½,æ”¯æŒé«˜å¹¶å‘
- âœ… å•ä¸€äºŒè¿›åˆ¶,éƒ¨ç½²ç®€å•

**æƒè¡¡**: æœªæ¥æ‰©å±•æ—¶å¯èƒ½éœ€è¦æ‹†åˆ†å¾®æœåŠ¡

#### å†³ç­– 2: PostgreSQL + pgvector

**é€‰æ‹©**: ä½¿ç”¨ PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“,pgvector å®ç°å‘é‡æ£€ç´¢

**ç†ç”±**:
- âœ… ç®€åŒ–æ¶æ„,æ— éœ€ç‹¬ç«‹å‘é‡æ•°æ®åº“
- âœ… äº‹åŠ¡ä¸€è‡´æ€§,å…³ç³»æ•°æ®å’Œå‘é‡æ•°æ®ç»Ÿä¸€ç®¡ç†
- âœ… é™ä½æˆæœ¬,å‡å°‘åŸºç¡€è®¾æ–½å¼€é”€
- âœ… pgvector æ€§èƒ½æ»¡è¶³å½“å‰éœ€æ±‚

**æƒè¡¡**: å‘é‡è§„æ¨¡è¶…è¿‡ 1000 ä¸‡å¯èƒ½éœ€è¦è¿ç§»è‡³ä¸“ç”¨å‘é‡åº“

#### å†³ç­– 3: æš‚ä¸å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—

**é€‰æ‹©**: ä½¿ç”¨æ•°æ®åº“è½®è¯¢ + å®šæ—¶ä»»åŠ¡å¤„ç†å¼‚æ­¥ä»»åŠ¡

**ç†ç”±**:
- âœ… ç®€åŒ–æ¶æ„,å‡å°‘æŠ€æœ¯æ ˆå¤æ‚åº¦
- âœ… æ˜“äºè°ƒè¯•,ä»»åŠ¡çŠ¶æ€å¯è¿½è¸ª
- âœ… å½“å‰å¹¶å‘é‡ä¸å¤§,æ€§èƒ½å……è¶³
- âœ… å¿«é€Ÿè¿­ä»£,ä¸“æ³¨ä¸šåŠ¡é€»è¾‘

**æƒè¡¡**: é«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½éœ€è¦å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—

### 2.3 ä»£ç ç›®å½•ç»“æ„(æ¶æ„æ–‡ä»¶å¤¹å›¾)

> åŸºäº 2025-11-18 çš„ä»“åº“çŠ¶æ€,æ¢³ç†å‡ºä¸‹è¿°ç›®å½•ç»“æ„,ç”¨äºæ˜ å°„æ¶æ„æ¨¡å—ä¸ç‰©ç†æ–‡ä»¶å¤¹ã€‚

```
AgentFlowCreativeHub/
â”œâ”€â”€ backend/                 # Go å•ä½“æœåŠ¡ä¸»ä½“
â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â””â”€â”€ server/          # ç¨‹åºå…¥å£ main.go
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ handlers/        # HTTP å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ setup.go         # è·¯ç”±ä¸ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ internal/            # ä¸šåŠ¡ä¸åŸºç¡€èƒ½åŠ›æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ agent/
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ audit/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ infra/
â”‚   â”‚   â”œâ”€â”€ logger/
â”‚   â”‚   â”œâ”€â”€ metrics/
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ notification/
â”‚   â”‚   â”œâ”€â”€ rag/
â”‚   â”‚   â”œâ”€â”€ template/
â”‚   â”‚   â”œâ”€â”€ tenant/
â”‚   â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â””â”€â”€ workflow/        # å·¥ä½œæµç¼–æ’ä¸ä»»åŠ¡æ‰§è¡Œ
â”‚   â”œâ”€â”€ pkg/
â”‚   â”‚   â”œâ”€â”€ aiinterface/
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”œâ”€â”€ go.mod
â”‚   â””â”€â”€ go.sum
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ dev.yaml | prod.yaml
â”‚   â”œâ”€â”€ agent_capabilities.yaml
â”‚   â”œâ”€â”€ automation_example.yaml
â”‚   â”œâ”€â”€ workflow_templates.yaml
â”‚   â”œâ”€â”€ grafana/
â”‚   â””â”€â”€ prometheus/
â”œâ”€â”€ db/
â”‚   â””â”€â”€ migrations/          # SQL è¿ç§»è„šæœ¬
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ æ¶æ„è®¾è®¡æ–‡æ¡£.md
â”‚   â””â”€â”€ éœ€æ±‚/æŠ€æœ¯/æ„å»ºç­‰æ ¸å¿ƒæ–‡æ¡£
â”œâ”€â”€ .factory/                # å·¥å‚ AI å·¥å…·é…ç½®
â””â”€â”€ docker-compose.monitoring.yml ç­‰è¿ç»´å…¥å£
```

ä¸Šè¿°â€œæ¶æ„æ–‡ä»¶å¤¹å›¾â€ä¸ç¬¬ 3 ç« çš„é€»è¾‘åˆ†å±‚ä¸€ä¸€å¯¹åº”: `backend/internal` ä¸‹çš„æ¯ä¸ªå­ç›®å½•å³å¯¹åº”ä¸€ä¸ªé¢†åŸŸæ¨¡å—; `config` æ‰¿è½½ç¯å¢ƒä¸ç›‘æ§æ¨¡æ¿,æ”¯æ’‘éƒ¨ç½²ç« èŠ‚; `db/migrations` ä¸ç¬¬ 4 ç« çš„æ•°æ®æ¶æ„ç»‘å®š; `docs` åˆ™ä»…ä¿ç•™å½“å‰çš„æ ¸å¿ƒæŠ€æœ¯æ–‡æ¡£,é¿å…ä¸´æ—¶æ–‡ä»¶å¹²æ‰°æ¶æ„è§†å›¾ã€‚

---

## 3. æ¨¡å—è®¾è®¡

### 3.1 æ¨¡å—åˆ†å±‚

```
cmd/
â””â”€â”€ server/           # ä¸»ç¨‹åºå…¥å£
    â””â”€â”€ main.go

internal/             # å†…éƒ¨åŒ…(ä¸å¯¹å¤–æš´éœ²)
â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”œâ”€â”€ logger/          # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ infra/           # åŸºç¡€è®¾æ–½(æ•°æ®åº“ã€Redis)
â”œâ”€â”€ middleware/      # HTTP ä¸­é—´ä»¶
â”œâ”€â”€ tenant/          # ç§Ÿæˆ·ç®¡ç†æ¨¡å—
â”œâ”€â”€ user/            # ç”¨æˆ·ç®¡ç†æ¨¡å—
â”œâ”€â”€ model/           # AI æ¨¡å‹ç®¡ç†æ¨¡å—
â”œâ”€â”€ template/        # Prompt æ¨¡æ¿ç®¡ç†æ¨¡å—
â”œâ”€â”€ agent/           # Agent é…ç½®ç®¡ç†æ¨¡å—
â”œâ”€â”€ workflow/        # å·¥ä½œæµç¼–æ’æ¨¡å—
â”œâ”€â”€ rag/             # RAG çŸ¥è¯†åº“æ¨¡å—
â””â”€â”€ audit/           # å®¡è®¡æ—¥å¿—æ¨¡å—

api/                 # API è·¯ç”±å±‚
â””â”€â”€ router.go        # è·¯ç”±æ³¨å†Œ
```

### 3.2 æ¨¡å—èŒè´£

#### 3.2.1 ç§Ÿæˆ·ç®¡ç† (Tenant)

**èŒè´£**:
- ç§Ÿæˆ· CRUD
- ç§Ÿæˆ·é…ç½®ç®¡ç†
- ç§Ÿæˆ·éš”ç¦»é€»è¾‘

**æ ¸å¿ƒæ¥å£**:
```go
type TenantService interface {
    Create(ctx context.Context, tenant *Tenant) error
    GetByID(ctx context.Context, id string) (*Tenant, error)
    Update(ctx context.Context, tenant *Tenant) error
    Delete(ctx context.Context, id string) error
}
```

#### 3.2.2 ç”¨æˆ·ç®¡ç† (User)

**èŒè´£**:
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•
- å¯†ç ç®¡ç†
- JWT Token ç”Ÿæˆå’ŒéªŒè¯
- RBAC æƒé™æ§åˆ¶

**æ ¸å¿ƒæ¥å£**:
```go
type UserService interface {
    Register(ctx context.Context, req *RegisterRequest) (*User, error)
    Login(ctx context.Context, req *LoginRequest) (string, error)
    GetByID(ctx context.Context, id string) (*User, error)
}
```

#### 3.2.3 æ¨¡å‹ç®¡ç† (Model)

**èŒè´£**:
- æ¨¡å‹æä¾›å•†ç®¡ç†(OpenAIã€Claude ç­‰)
- æ¨¡å‹é…ç½®(API Keyã€Base URL)
- æ¨¡å‹è°ƒç”¨ç»Ÿè®¡

**æ ¸å¿ƒæ¥å£**:
```go
type ModelService interface {
    ListModels(ctx context.Context, tenantID string) ([]*Model, error)
    CallModel(ctx context.Context, req *ModelRequest) (*ModelResponse, error)
    GetUsage(ctx context.Context, tenantID string) (*Usage, error)
}
```

#### 3.2.4 æ¨¡æ¿ç®¡ç† (Template)

**èŒè´£**:
- Prompt æ¨¡æ¿ CRUD
- æ¨¡æ¿ç‰ˆæœ¬ç®¡ç†
- æ¨¡æ¿å‚æ•°åŒ–

**æ ¸å¿ƒæ¥å£**:
```go
type TemplateService interface {
    Create(ctx context.Context, template *Template) error
    GetByID(ctx context.Context, id string) (*Template, error)
    Render(ctx context.Context, id string, params map[string]interface{}) (string, error)
}
```

#### 3.2.5 Agent ç®¡ç† (Agent)

**èŒè´£**:
- Agent é…ç½®ç®¡ç†
- Agent èƒ½åŠ›å®šä¹‰
- Agent è°ƒç”¨

**æ ¸å¿ƒæ¥å£**:
```go
type AgentService interface {
    Create(ctx context.Context, agent *Agent) error
    Execute(ctx context.Context, id string, input *AgentInput) (*AgentOutput, error)
}
```

#### 3.2.6 å·¥ä½œæµç¼–æ’ (Workflow)

**èŒè´£**:
- å·¥ä½œæµå®šä¹‰
- å·¥ä½œæµæ‰§è¡Œ
- ä»»åŠ¡è°ƒåº¦

**æ ¸å¿ƒæ¥å£**:
```go
type WorkflowService interface {
    Create(ctx context.Context, workflow *Workflow) error
    Execute(ctx context.Context, id string, input map[string]interface{}) (*Execution, error)
    GetStatus(ctx context.Context, executionID string) (*ExecutionStatus, error)
}
```

#### 3.2.7 RAG çŸ¥è¯†åº“ (RAG)

**èŒè´£**:
- çŸ¥è¯†åº“ç®¡ç†
- æ–‡æ¡£ä¸Šä¼ å’Œåˆ‡åˆ†
- å‘é‡æ£€ç´¢

**æ ¸å¿ƒæ¥å£**:
```go
type RAGService interface {
    CreateKnowledgeBase(ctx context.Context, kb *KnowledgeBase) error
    UploadDocument(ctx context.Context, kbID string, doc *Document) error
    Search(ctx context.Context, kbID string, query string, topK int) ([]*Chunk, error)
}
```

---

## 4. æ•°æ®å­˜å‚¨æ¶æ„

### 4.1 PostgreSQL æ•°æ®åº“è®¾è®¡

**æ ¸å¿ƒè¡¨**:
- `tenants` - ç§Ÿæˆ·è¡¨
- `users` - ç”¨æˆ·è¡¨
- `roles` - è§’è‰²è¡¨
- `permissions` - æƒé™è¡¨
- `models` - æ¨¡å‹è¡¨
- `prompt_templates` - Prompt æ¨¡æ¿è¡¨
- `agents` - Agent é…ç½®è¡¨
- `workflows` - å·¥ä½œæµå®šä¹‰è¡¨
- `workflow_executions` - å·¥ä½œæµæ‰§è¡Œè®°å½•è¡¨
- `knowledge_bases` - çŸ¥è¯†åº“è¡¨
- `knowledge_documents` - çŸ¥è¯†æ–‡æ¡£è¡¨
- `knowledge_chunks` - çŸ¥è¯†ç‰‡æ®µè¡¨(å«å‘é‡)
- `audit_logs` - å®¡è®¡æ—¥å¿—è¡¨

**è¯¦ç»†è®¾è®¡**: å‚è€ƒ [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](./æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md)

### 4.2 Redis ç¼“å­˜è®¾è®¡

**ç¼“å­˜ç­–ç•¥**:
```
ç”¨æˆ·ä¼šè¯:     user:session:{user_id} (TTL: 7å¤©)
æ¨¡å‹åˆ—è¡¨:     tenant:{tenant_id}:models (TTL: 1å°æ—¶)
æ¨¡æ¿åˆ—è¡¨:     tenant:{tenant_id}:templates (TTL: 1å°æ—¶)
API é™æµ:     ratelimit:{tenant_id}:{api} (TTL: 1åˆ†é’Ÿ)
åˆ†å¸ƒå¼é”:     lock:{resource}:{id} (TTL: 30ç§’)
```

---

## 5. å¤šç§Ÿæˆ·æ–¹æ¡ˆ

### 5.1 æ•°æ®éš”ç¦»

**æ–¹æ¡ˆ**: å…±äº«æ•°æ®åº“ + ç§Ÿæˆ·å­—æ®µè¿‡æ»¤

**å®ç°**:
- æ‰€æœ‰ä¸šåŠ¡è¡¨åŒ…å« `tenant_id` å­—æ®µ
- ä¸­é—´ä»¶è‡ªåŠ¨æ³¨å…¥ç§Ÿæˆ·ä¸Šä¸‹æ–‡
- æŸ¥è¯¢è‡ªåŠ¨æ·»åŠ  `tenant_id` è¿‡æ»¤æ¡ä»¶

**ç¤ºä¾‹**:
```go
// ä¸­é—´ä»¶æ³¨å…¥ç§Ÿæˆ· ID
func TenantMiddleware() gin.HandlerFunc {
    return func(c *gin.Context) {
        tenantID := extractTenantID(c)
        c.Set("tenant_id", tenantID)
        c.Next()
    }
}

// æŸ¥è¯¢è‡ªåŠ¨è¿‡æ»¤
func (s *Service) GetByID(ctx context.Context, id string) (*Model, error) {
    tenantID := ctx.Value("tenant_id").(string)
    var model Model
    err := s.db.Where("id = ? AND tenant_id = ?", id, tenantID).First(&model).Error
    return &model, err
}
```

### 5.2 èµ„æºé…é¢

**é…é¢ç®¡ç†**:
- ç”¨æˆ·æ•°é™åˆ¶
- å·¥ä½œæµæ•°é™åˆ¶
- API è°ƒç”¨é™åˆ¶
- å­˜å‚¨ç©ºé—´é™åˆ¶

**å®ç°**:
```go
type TenantConfig struct {
    MaxUsers      int
    MaxWorkflows  int
    MaxAPICallsPerDay int
    MaxStorageGB  int
}
```

---

## 6. å®‰å…¨ä¸æƒé™è®¾è®¡

### 6.1 è®¤è¯æœºåˆ¶

**æ–¹æ¡ˆ**: JWT Token è®¤è¯

**æµç¨‹**:
```
1. ç”¨æˆ·ç™»å½• â†’ éªŒè¯ç”¨æˆ·åå¯†ç 
2. ç”Ÿæˆ JWT Token (æœ‰æ•ˆæœŸ 7 å¤©)
3. è¿”å› Token ç»™å®¢æˆ·ç«¯
4. åç»­è¯·æ±‚æºå¸¦ Token (Header: Authorization: Bearer <token>)
5. ä¸­é—´ä»¶éªŒè¯ Token æœ‰æ•ˆæ€§
```

### 6.2 æƒé™æ§åˆ¶ (RBAC)

**æ¨¡å‹**:
```
ç”¨æˆ· â†’ è§’è‰² â†’ æƒé™ â†’ èµ„æº

ç¤ºä¾‹:
- ç®¡ç†å‘˜è§’è‰²: æ‹¥æœ‰æ‰€æœ‰æƒé™
- ç¼–è¾‘è§’è‰²: å¯åˆ›å»ºã€ç¼–è¾‘å·¥ä½œæµå’Œæ¨¡æ¿
- æŸ¥çœ‹è€…è§’è‰²: åªèƒ½æŸ¥çœ‹
```

**æƒé™è¡¨è¾¾å¼**:
```
resource:action:scope

ç¤ºä¾‹:
- workflow:create:tenant  (åœ¨ç§Ÿæˆ·èŒƒå›´å†…åˆ›å»ºå·¥ä½œæµ)
- template:read:all       (è¯»å–æ‰€æœ‰æ¨¡æ¿)
- model:delete:own        (åˆ é™¤è‡ªå·±çš„æ¨¡å‹é…ç½®)
```

---

## 7. éƒ¨ç½²ä¸è¿ç»´

### 7.1 éƒ¨ç½²æ¶æ„

**åˆæœŸéƒ¨ç½²** (å•æœåŠ¡å™¨):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æœåŠ¡å™¨ (Linux)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Nginx (åå‘ä»£ç†)            â”‚ â”‚
â”‚  â”‚   â”œâ”€ HTTPS (443)              â”‚ â”‚
â”‚  â”‚   â””â”€ è½¬å‘åˆ° Backend (8080)    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Backend (Go äºŒè¿›åˆ¶)         â”‚ â”‚
â”‚  â”‚   â”œâ”€ HTTP Server (8080)       â”‚ â”‚
â”‚  â”‚   â””â”€ è¿æ¥ PostgreSQL + Redis  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   PostgreSQL (Docker)         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Redis (Docker)              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸­æœŸéƒ¨ç½²** (å¤šå®ä¾‹):
```
è´Ÿè½½å‡è¡¡ (Nginx)
    â†“
Backend å®ä¾‹ 1, 2, 3 (Go)
    â†“
PostgreSQL (ä¸»ä») + Redis (é›†ç¾¤)
```

### 7.2 ç›‘æ§ä¸æ—¥å¿—

**ç›‘æ§æŒ‡æ ‡**:
- CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- HTTP è¯·æ±‚ QPSã€å»¶è¿Ÿã€é”™è¯¯ç‡
- æ•°æ®åº“è¿æ¥æ•°ã€æ…¢æŸ¥è¯¢
- Redis å‘½ä¸­ç‡ã€å†…å­˜ä½¿ç”¨

**æ—¥å¿—æ”¶é›†**:
- åº”ç”¨æ—¥å¿—: JSON æ ¼å¼,åŒ…å« trace_id
- è®¿é—®æ—¥å¿—: Nginx æ—¥å¿—
- é”™è¯¯æ—¥å¿—: å¼‚å¸¸å †æ ˆä¿¡æ¯

---

## 8. æ‰©å±•æ€§ä¸æ¼”åŒ–è·¯å¾„

### 8.1 æ°´å¹³æ‰©å±•

**æ”¯æŒ**:
- âœ… æ— çŠ¶æ€è®¾è®¡,æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
- âœ… è´Ÿè½½å‡è¡¡åˆ†å‘è¯·æ±‚
- âœ… Session å­˜å‚¨åœ¨ Redis,æ”¯æŒå…±äº«

### 8.2 å¾®æœåŠ¡æ‹†åˆ† (æœªæ¥)

**æ‹†åˆ†ç­–ç•¥**:
- è®¤è¯æœåŠ¡ (ç‹¬ç«‹)
- Agent æœåŠ¡ (ç‹¬ç«‹)
- RAG æœåŠ¡ (ç‹¬ç«‹)
- å·¥ä½œæµæœåŠ¡ (ç‹¬ç«‹)

**é€šä¿¡æ–¹å¼**:
- gRPC (å†…éƒ¨æœåŠ¡é—´)
- REST (å¯¹å¤– API)

---

## 9. é£é™©ä¸æŒ‘æˆ˜

### 9.1 æ€§èƒ½ç“¶é¢ˆ

**é£é™©**: é«˜å¹¶å‘ä¸‹æ•°æ®åº“å‹åŠ›å¤§

**ç¼“è§£**:
- æ•°æ®åº“è¿æ¥æ± ä¼˜åŒ–
- Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
- æ…¢æŸ¥è¯¢ä¼˜åŒ–å’Œç´¢å¼•

### 9.2 å•ç‚¹æ•…éšœ

**é£é™©**: å•å®ä¾‹éƒ¨ç½²å­˜åœ¨å•ç‚¹æ•…éšœ

**ç¼“è§£**:
- å¤šå®ä¾‹éƒ¨ç½² + è´Ÿè½½å‡è¡¡
- æ•°æ®åº“ä¸»ä»å¤åˆ¶
- å®šæœŸå¤‡ä»½

### 9.3 å‘é‡æ£€ç´¢æ€§èƒ½

**é£é™©**: pgvector åœ¨å¤§è§„æ¨¡å‘é‡æ—¶æ€§èƒ½ä¸‹é™

**ç¼“è§£**:
- æ§åˆ¶å‘é‡è§„æ¨¡ (åˆ†åº“ã€å½’æ¡£)
- HNSW ç´¢å¼•ä¼˜åŒ–
- å¿…è¦æ—¶è¿ç§»è‡³ä¸“ç”¨å‘é‡åº“

---

**ç›¸å…³æ–‡æ¡£**:
- [æŠ€æœ¯æ ˆæ–‡æ¡£](./æŠ€æœ¯æ ˆæ–‡æ¡£.md)
- [æ•°æ®åº“è®¾è®¡æ–‡æ¡£](./æ•°æ®åº“è®¾è®¡æ–‡æ¡£.md)
- [é¡¹ç›®æ„å»ºæŒ‡å—](./é¡¹ç›®æ„å»ºæŒ‡å—.md)
