# 下一阶段建议方案

## 1. 后端：权限点覆盖/审计补完
- 为核心 Handler 明确 `resource/action` 映射，完成对命令、工作流、知识库、文件操作的权限标注，并在 `MiddlewareFactory` 中统一使用。
- 在角色/用户角色的增删改操作中写入审计日志（权限授予/回收事件），便于追踪。

## 2. 前端：租户角色管理 UI
- 在租户设置页新增“角色/权限”管理页面：
  - 展示 `ListRoles` 返回的角色表格（名称、描述、权限数、系统角色标识）。
  - 点击行弹出抽屉，复选 `ListPermissions` 权限树并调用 `UpdateRole`。
  - 支持创建/删除角色、拖动排序（映射 priority 字段）。
- 用户管理页增加“角色分配”对话框，调用 `ReplaceUserRoles` 批量保存。

## 3. 数据同步与多租户默认角色
- 在 `tenantService.CreateTenant` 完成后调用 `EnsureTenantDefaultRoles`，自动为新租户创建管理员、编辑者、访客等角色并关联默认权限。
- 迁移脚本补充：为已有租户插入默认角色或提示运维脚本执行。

## 4. 验证
- 后端继续 `go test ./...` 覆盖 role/permission 新逻辑。
- 前端：`npm run lint && npm run test`，新增租户角色页面组件测试与权限表单快照。

若方向确认，我将按此计划推进下一阶段实现。