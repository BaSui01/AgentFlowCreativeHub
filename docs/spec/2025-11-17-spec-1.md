# ğŸ” æ•°æ®åº“æ ¸å¿ƒè¡¨å­—æ®µå®Œå–„æ€§æ·±åº¦åˆ†æ

## ğŸ“Š ç°çŠ¶æ€»ç»“

### âœ… å·²å®Œæˆçš„å·¥ä½œ
1. **åŸºç¡€ç§Ÿæˆ·è¡¨**ï¼šTenantã€Userã€Role - å·²å®Œå–„ï¼ˆè½¯åˆ é™¤ã€è¯¦ç»†å­—æ®µï¼‰
2. **RAG è¡¨**ï¼šKnowledgeBaseã€KnowledgeDocumentã€KnowledgeChunk - å·²å®Œå–„
3. **å®¡è®¡è¡¨**ï¼šAuditLog - å·²å®Œå–„ï¼ˆè¯·æ±‚ä¸Šä¸‹æ–‡ã€å˜æ›´è®°å½•ï¼‰

### âš ï¸ å‘ç°çš„ç¼ºå¤±æ¨¡å—ï¼ˆéœ€è¦è¡¥å…… Go æ¨¡å‹ï¼‰

ä»æ•°æ®åº“è®¾è®¡æ–‡æ¡£ä¸­å‘ç°äº†å¤šä¸ª**é‡è¦ä¸šåŠ¡è¡¨å°šæœªå®ç° Go æ¨¡å‹**ï¼š

---

## ğŸš¨ å…³é”®ç¼ºå¤±è¡¨ï¼ˆä¼˜å…ˆçº§ P0ï¼‰

### 1. **models è¡¨** - AI æ¨¡å‹ç®¡ç† âŒ æœªå®ç°

**æ•°æ®åº“è®¾è®¡å·²æœ‰**ï¼Œä½† **Go æ¨¡å‹ç¼ºå¤±**

<details>
<summary>éœ€è¦åˆ›å»ºçš„æ¨¡å‹</summary>

```go
// backend/internal/models/models.go
package models

import "time"

// Model AI æ¨¡å‹é…ç½®
type Model struct {
    ID   string `json:"id" gorm:"primaryKey;type:uuid"`
    
    // æ¨¡å‹ä¿¡æ¯
    Name     string `json:"name" gorm:"size:100;not null;uniqueIndex"`
    Provider string `json:"provider" gorm:"size:50;not null"` // openai, anthropic, custom
    Type     string `json:"type" gorm:"size:50;not null"`     // chat, embedding
    
    // èƒ½åŠ›æè¿°
    Description              string `json:"description" gorm:"type:text"`
    MaxTokens                int    `json:"maxTokens"`
    SupportsStreaming        bool   `json:"supportsStreaming" gorm:"default:false"`
    SupportsFunctionCalling  bool   `json:"supportsFunctionCalling" gorm:"default:false"`
    
    // æˆæœ¬ï¼ˆæŒ‰ 1000 tokens è®¡ç®—ï¼‰
    InputCostPer1K  float64 `json:"inputCostPer1k" gorm:"type:decimal(10,6)"`
    OutputCostPer1K float64 `json:"outputCostPer1k" gorm:"type:decimal(10,6)"`
    
    // çŠ¶æ€
    Status string `json:"status" gorm:"size:50;not null;default:active"` // active, deprecated, disabled
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time  `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time  `json:"updatedAt" gorm:"not null;autoUpdateTime"`
    DeletedAt *time.Time `json:"deletedAt,omitempty" gorm:"index"`
}

// ModelCallLog æ¨¡å‹è°ƒç”¨æ—¥å¿—
type ModelCallLog struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;not null;index"`
    UserID   string `json:"userId" gorm:"type:uuid;index"`
    ModelID  string `json:"modelId" gorm:"type:uuid;not null;index"`
    
    // Token ç»Ÿè®¡
    PromptTokens     int `json:"promptTokens" gorm:"not null"`
    CompletionTokens int `json:"completionTokens" gorm:"not null"`
    TotalTokens      int `json:"totalTokens" gorm:"not null"`
    
    // æˆæœ¬
    TotalCost float64 `json:"totalCost" gorm:"type:decimal(10,6)"`
    
    // æ€§èƒ½
    LatencyMs int `json:"latencyMs"`
    
    // å…³è”
    WorkflowExecutionID string `json:"workflowExecutionId" gorm:"type:uuid;index"`
    TaskID              string `json:"taskId" gorm:"type:uuid;index"`
    
    // è¿½è¸ª
    TraceID string `json:"traceId" gorm:"size:100;index"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime;index"`
}
```

**ç¼ºå¤±å­—æ®µåˆ†æ**ï¼šâœ… æ•°æ®åº“è®¾è®¡å®Œæ•´ï¼Œéœ€è¦åŒæ­¥åˆ›å»º Go æ¨¡å‹

</details>

---

### 2. **prompt_templates è¡¨** - Prompt æ¨¡æ¿ç®¡ç† âŒ æœªå®ç°

**æ•°æ®åº“è®¾è®¡å·²æœ‰**ï¼Œä½† **Go æ¨¡å‹ç¼ºå¤±**

<details>
<summary>éœ€è¦åˆ›å»ºçš„æ¨¡å‹</summary>

```go
// backend/internal/template/models.go
package template

import "time"

// PromptTemplate Prompt æ¨¡æ¿
type PromptTemplate struct {
    ID            string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID      string `json:"tenantId" gorm:"type:uuid;not null;index"`
    OwnerUserID   string `json:"ownerUserId" gorm:"type:uuid;index"`
    
    // æ¨¡æ¿ä¿¡æ¯
    Name        string `json:"name" gorm:"size:255;not null"`
    Description string `json:"description" gorm:"type:text"`
    Category    string `json:"category" gorm:"size:100"` // writing, reviewing, formatting
    
    // å¯è§æ€§
    Visibility string `json:"visibility" gorm:"size:50;not null;default:personal"` // personal, tenant, public
    
    // æœ€æ–°ç‰ˆæœ¬
    CurrentVersionID string `json:"currentVersionId" gorm:"type:uuid"`
    
    // ç»Ÿè®¡
    UsageCount int `json:"usageCount" gorm:"default:0"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time  `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time  `json:"updatedAt" gorm:"not null;autoUpdateTime"`
    DeletedAt *time.Time `json:"deletedAt,omitempty" gorm:"index"`
}

// PromptTemplateVersion æ¨¡æ¿ç‰ˆæœ¬
type PromptTemplateVersion struct {
    ID         string `json:"id" gorm:"primaryKey;type:uuid"`
    TemplateID string `json:"templateId" gorm:"type:uuid;not null;index"`
    
    // ç‰ˆæœ¬ä¿¡æ¯
    Version   string         `json:"version" gorm:"size:50;not null"`
    Content   string         `json:"content" gorm:"type:text;not null"`
    Variables map[string]any `json:"variables" gorm:"type:jsonb;serializer:json"`
    
    // å˜æ›´è¯´æ˜
    Changelog string `json:"changelog" gorm:"type:text"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
}
```

**ç¼ºå¤±å­—æ®µåˆ†æ**ï¼šâœ… æ•°æ®åº“è®¾è®¡å®Œæ•´ï¼Œéœ€è¦åŒæ­¥åˆ›å»º Go æ¨¡å‹

</details>

---

### 3. **workflows è¡¨** - å·¥ä½œæµç®¡ç† âŒ æœªå®ç°

**æ•°æ®åº“è®¾è®¡å·²æœ‰**ï¼Œä½† **Go æ¨¡å‹ç¼ºå¤±**

<details>
<summary>éœ€è¦åˆ›å»ºçš„æ¨¡å‹</summary>

```go
// backend/internal/workflow/models.go
package workflow

import "time"

// Workflow å·¥ä½œæµå®šä¹‰
type Workflow struct {
    ID          string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID    string `json:"tenantId" gorm:"type:uuid;not null;index"`
    OwnerUserID string `json:"ownerUserId" gorm:"type:uuid;index"`
    
    // å·¥ä½œæµä¿¡æ¯
    Name        string `json:"name" gorm:"size:255;not null"`
    Description string `json:"description" gorm:"type:text"`
    
    // å®šä¹‰ï¼ˆYAML/JSONï¼‰
    Definition map[string]any `json:"definition" gorm:"type:jsonb;not null;serializer:json"`
    
    // ç‰ˆæœ¬
    Version string `json:"version" gorm:"size:50;not null"`
    
    // å¯è§æ€§
    Visibility string `json:"visibility" gorm:"size:50;not null;default:personal"` // personal, tenant, public
    
    // ç»Ÿè®¡
    ExecutionCount int `json:"executionCount" gorm:"default:0"`
    SuccessCount   int `json:"successCount" gorm:"default:0"`
    FailureCount   int `json:"failureCount" gorm:"default:0"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time  `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time  `json:"updatedAt" gorm:"not null;autoUpdateTime"`
    DeletedAt *time.Time `json:"deletedAt,omitempty" gorm:"index"`
}

// WorkflowExecution å·¥ä½œæµæ‰§è¡Œè®°å½•
type WorkflowExecution struct {
    ID         string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID   string `json:"tenantId" gorm:"type:uuid;not null;index"`
    WorkflowID string `json:"workflowId" gorm:"type:uuid;not null;index"`
    UserID     string `json:"userId" gorm:"type:uuid;index"`
    
    // çŠ¶æ€
    Status string `json:"status" gorm:"size:50;not null;default:pending"` // pending, running, completed, failed, paused
    
    // è¾“å…¥è¾“å‡º
    Input        map[string]any `json:"input" gorm:"type:jsonb;serializer:json"`
    Output       map[string]any `json:"output" gorm:"type:jsonb;serializer:json"`
    ErrorMessage string         `json:"errorMessage" gorm:"type:text"`
    
    // æ—¶é—´
    StartedAt   *time.Time `json:"startedAt"`
    CompletedAt *time.Time `json:"completedAt"`
    
    // è¿½è¸ª
    TraceID string `json:"traceId" gorm:"size:100;index"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
}

// WorkflowTask å·¥ä½œæµä»»åŠ¡
type WorkflowTask struct {
    ID          string `json:"id" gorm:"primaryKey;type:uuid"`
    ExecutionID string `json:"executionId" gorm:"type:uuid;not null;index"`
    
    // ä»»åŠ¡ä¿¡æ¯
    StepID    string `json:"stepId" gorm:"size:100;not null"`
    AgentType string `json:"agentType" gorm:"size:100;not null"`
    
    // çŠ¶æ€
    Status string `json:"status" gorm:"size:50;not null;default:pending"`
    
    // è¾“å…¥è¾“å‡º
    Input        map[string]any `json:"input" gorm:"type:jsonb;serializer:json"`
    Output       map[string]any `json:"output" gorm:"type:jsonb;serializer:json"`
    ErrorMessage string         `json:"errorMessage" gorm:"type:text"`
    
    // æ—¶é—´
    StartedAt   *time.Time `json:"startedAt"`
    CompletedAt *time.Time `json:"completedAt"`
    
    // é‡è¯•
    RetryCount int `json:"retryCount" gorm:"default:0"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
}
```

**ç¼ºå¤±å­—æ®µåˆ†æ**ï¼šâœ… æ•°æ®åº“è®¾è®¡å®Œæ•´ï¼Œéœ€è¦åŒæ­¥åˆ›å»º Go æ¨¡å‹

</details>

---

### 4. **agent_configs è¡¨** - Agent é…ç½® âŒ æœªå®ç°

**æ•°æ®åº“è®¾è®¡å·²æœ‰**ï¼Œä½† **Go æ¨¡å‹ç¼ºå¤±**

<details>
<summary>éœ€è¦åˆ›å»ºçš„æ¨¡å‹</summary>

```go
// backend/internal/agent/models.go
package agent

import "time"

// AgentConfig Agent é…ç½®
type AgentConfig struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;not null;index"`
    
    // Agent ä¿¡æ¯
    AgentType   string `json:"agentType" gorm:"size:100;not null"`   // writer, reviewer, planner
    Name        string `json:"name" gorm:"size:255;not null"`
    Description string `json:"description" gorm:"type:text"`
    
    // æ¨¡å‹é…ç½®
    ModelID           string `json:"modelId" gorm:"type:uuid;not null"`
    PromptTemplateID  string `json:"promptTemplateId" gorm:"type:uuid"`
    
    // å‚æ•°
    Temperature float64 `json:"temperature" gorm:"type:decimal(3,2);default:0.7"`
    MaxTokens   int     `json:"maxTokens" gorm:"default:4096"`
    
    // æ‰©å±•é…ç½®
    ExtraConfig map[string]any `json:"extraConfig" gorm:"type:jsonb;serializer:json"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time  `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time  `json:"updatedAt" gorm:"not null;autoUpdateTime"`
    DeletedAt *time.Time `json:"deletedAt,omitempty" gorm:"index"`
}
```

**ç¼ºå¤±å­—æ®µåˆ†æ**ï¼šâœ… æ•°æ®åº“è®¾è®¡å®Œæ•´ï¼Œéœ€è¦åŒæ­¥åˆ›å»º Go æ¨¡å‹

</details>

---

## ğŸ“‹ å·²æœ‰æ¨¡å‹éœ€è¦è¡¥å……çš„å­—æ®µ

### 1. Permission æ¨¡å‹ - éœ€è¦è¡¥å……å­—æ®µ

**ç°çŠ¶**ï¼šç¼ºå°‘ GORM æ ‡ç­¾å’Œæ—¶é—´æˆ³

```go
// å½“å‰æ¨¡å‹ï¼ˆä¸å®Œæ•´ï¼‰
type Permission struct {
    ID       string `json:"id"`
    TenantID string `json:"tenantId"`
    Resource string `json:"resource"`
    Action   string `json:"action"`
}
```

**å»ºè®®å®Œå–„**ï¼š
```go
type Permission struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;index"` // NULL è¡¨ç¤ºå…¨å±€æƒé™
    
    Resource    string `json:"resource" gorm:"size:100;not null"`
    Action      string `json:"action" gorm:"size:100;not null"`
    Description string `json:"description" gorm:"type:text"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time `json:"updatedAt" gorm:"not null;autoUpdateTime"`
}
```

---

### 2. UserRole / RolePermission æ¨¡å‹ - éœ€è¦è¡¥å……å­—æ®µ

**ç°çŠ¶**ï¼šç¼ºå°‘ GORM æ ‡ç­¾å’Œæ—¶é—´æˆ³

```go
// å½“å‰æ¨¡å‹ï¼ˆä¸å®Œæ•´ï¼‰
type UserRole struct {
    ID       string `json:"id"`
    TenantID string `json:"tenantId"`
    UserID   string `json:"userId"`
    RoleID   string `json:"roleId"`
}
```

**å»ºè®®å®Œå–„**ï¼š
```go
type UserRole struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;not null;index"`
    UserID   string `json:"userId" gorm:"type:uuid;not null;index"`
    RoleID   string `json:"roleId" gorm:"type:uuid;not null;index"`
    
    // æƒé™ç”Ÿæ•ˆæ—¶é—´ï¼ˆå¯é€‰ï¼‰
    EffectiveFrom *time.Time `json:"effectiveFrom"`
    EffectiveUntil *time.Time `json:"effectiveUntil"`
    
    // æˆäºˆä¿¡æ¯
    GrantedBy string `json:"grantedBy" gorm:"type:uuid"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
}

type RolePermission struct {
    ID           string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID     string `json:"tenantId" gorm:"type:uuid;not null;index"`
    RoleID       string `json:"roleId" gorm:"type:uuid;not null;index"`
    PermissionID string `json:"permissionId" gorm:"type:uuid;not null;index"`
    
    // æƒé™çº¦æŸï¼ˆå¯é€‰ï¼‰
    Conditions map[string]any `json:"conditions" gorm:"type:jsonb;serializer:json"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
}
```

---

### 3. TenantConfig æ¨¡å‹ - éœ€è¦è¡¥å……å­—æ®µå’Œé‡æ„

**ç°çŠ¶**ï¼šå­—æ®µè¿‡äºç®€å•ï¼Œç¼ºå°‘ AI å’Œå·¥ä½œæµé…ç½®

```go
// å½“å‰æ¨¡å‹ï¼ˆä¸å®Œæ•´ï¼‰
type TenantConfig struct {
    TenantID     string            `json:"tenantId"`
    DisplayName  string            `json:"displayName"`
    Description  string            `json:"description"`
    LogoURL      string            `json:"logoUrl"`
    Language     string            `json:"language"`
    TimeZone     string            `json:"timeZone"`
    FeatureFlags map[string]bool   `json:"featureFlags"`
}
```

**å»ºè®®å®Œå–„**ï¼š
```go
type TenantConfig struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;not null;uniqueIndex"`
    
    // å“ç‰Œä¿¡æ¯
    DisplayName string `json:"displayName" gorm:"size:255"`
    Description string `json:"description" gorm:"type:text"`
    LogoURL     string `json:"logoUrl" gorm:"type:text"`
    
    // è¯­è¨€å’Œæ—¶åŒº
    Language string `json:"language" gorm:"size:10;default:zh-CN"`
    TimeZone string `json:"timezone" gorm:"size:64;default:Asia/Shanghai"`
    
    // AI é…ç½®
    DefaultModel         string  `json:"defaultModel" gorm:"size:100"`
    MaxTokensPerRequest  int     `json:"maxTokensPerRequest" gorm:"default:4096"`
    Temperature          float64 `json:"temperature" gorm:"type:decimal(3,2);default:0.7"`
    
    // RAG é…ç½®
    DefaultEmbeddingModel string  `json:"defaultEmbeddingModel" gorm:"size:100"`
    VectorSearchTopK      int     `json:"vectorSearchTopK" gorm:"default:10"`
    VectorSearchThreshold float64 `json:"vectorSearchThreshold" gorm:"type:decimal(3,2);default:0.7"`
    
    // å·¥ä½œæµé…ç½®
    MaxConcurrentWorkflows int `json:"maxConcurrentWorkflows" gorm:"default:5"`
    WorkflowTimeoutSeconds int `json:"workflowTimeoutSeconds" gorm:"default:3600"`
    
    // åŠŸèƒ½å¼€å…³
    FeatureFlags map[string]bool `json:"featureFlags" gorm:"type:jsonb;serializer:json"`
    
    // æ‰©å±•é…ç½®ï¼ˆJSONï¼‰
    ExtraConfig map[string]any `json:"extraConfig" gorm:"type:jsonb;serializer:json"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time `json:"updatedAt" gorm:"not null;autoUpdateTime"`
}
```

---

### 4. TenantQuota æ¨¡å‹ - éœ€è¦è¡¥å……å­—æ®µ

**ç°çŠ¶**ï¼šä»…æœ‰åŸºç¡€é…é¢å­—æ®µ

```go
// å½“å‰æ¨¡å‹ï¼ˆä¸å®Œæ•´ï¼‰
type TenantQuota struct {
    TenantID       string `json:"tenantId"`
    MaxUsers       int    `json:"maxUsers"`
    MaxStorageMB   int    `json:"maxStorageMb"`
    MaxWorkflows   int    `json:"maxWorkflows"`
    UsedUsers      int    `json:"usedUsers"`
    UsedStorageMB  int    `json:"usedStorageMb"`
    UsedWorkflows  int    `json:"usedWorkflows"`
}
```

**å»ºè®®å®Œå–„**ï¼š
```go
type TenantQuota struct {
    ID       string `json:"id" gorm:"primaryKey;type:uuid"`
    TenantID string `json:"tenantId" gorm:"type:uuid;not null;uniqueIndex"`
    
    // ç”¨æˆ·é…é¢
    MaxUsers  int `json:"maxUsers" gorm:"default:10"`
    UsedUsers int `json:"usedUsers" gorm:"default:0"`
    
    // å­˜å‚¨é…é¢ï¼ˆMBï¼‰
    MaxStorageMB  int `json:"maxStorageMb" gorm:"default:10240"`
    UsedStorageMB int `json:"usedStorageMb" gorm:"default:0"`
    
    // å·¥ä½œæµé…é¢
    MaxWorkflows  int `json:"maxWorkflows" gorm:"default:100"`
    UsedWorkflows int `json:"usedWorkflows" gorm:"default:0"`
    
    // çŸ¥è¯†åº“é…é¢
    MaxKnowledgeBases  int `json:"maxKnowledgeBases" gorm:"default:10"`
    UsedKnowledgeBases int `json:"usedKnowledgeBases" gorm:"default:0"`
    
    // AI è°ƒç”¨é…é¢
    MaxTokensPerMonth  int64 `json:"maxTokensPerMonth" gorm:"default:1000000"`
    UsedTokensThisMonth int64 `json:"usedTokensThisMonth" gorm:"default:0"`
    
    // API è°ƒç”¨é…é¢
    MaxAPICallsPerDay  int `json:"maxApiCallsPerDay" gorm:"default:10000"`
    UsedAPICallsToday  int `json:"usedApiCallsToday" gorm:"default:0"`
    
    // é…é¢é‡ç½®æ—¶é—´
    TokenQuotaResetAt   time.Time `json:"tokenQuotaResetAt"`
    APIQuotaResetAt     time.Time `json:"apiQuotaResetAt"`
    
    // æ—¶é—´æˆ³
    CreatedAt time.Time `json:"createdAt" gorm:"not null;autoCreateTime"`
    UpdatedAt time.Time `json:"updatedAt" gorm:"not null;autoUpdateTime"`
}
```

---

## ğŸ¯ å®æ–½å»ºè®®

### ä¼˜å…ˆçº§ P0ï¼ˆå¿…é¡»å®ç°ï¼‰

1. **åˆ›å»ºç¼ºå¤±çš„æ ¸å¿ƒæ¨¡å‹**ï¼š
   - `backend/internal/models/models.go` - Modelã€ModelCallLog
   - `backend/internal/template/models.go` - PromptTemplateã€PromptTemplateVersion
   - `backend/internal/workflow/models.go` - Workflowã€WorkflowExecutionã€WorkflowTask
   - `backend/internal/agent/models.go` - AgentConfig

2. **å®Œå–„å·²æœ‰æ¨¡å‹**ï¼š
   - Permission - æ·»åŠ  GORM æ ‡ç­¾å’Œæ—¶é—´æˆ³
   - UserRole/RolePermission - æ·»åŠ æƒé™ç”Ÿæ•ˆæ—¶é—´ã€æˆäºˆäºº
   - TenantConfig - æ·»åŠ  AI/RAG/å·¥ä½œæµé…ç½®
   - TenantQuota - æ·»åŠ çŸ¥è¯†åº“ã€Tokenã€API é…é¢

### ä¼˜å…ˆçº§ P1ï¼ˆå»ºè®®å®ç°ï¼‰

3. **åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“è¿ç§»è„šæœ¬**ï¼š
   - `db/migrations/0005_create_models_tables.sql`
   - `db/migrations/0006_create_template_tables.sql`
   - `db/migrations/0007_create_workflow_tables.sql`
   - `db/migrations/0008_create_agent_tables.sql`

4. **åˆ›å»ºå¯¹åº”çš„ Service å±‚**ï¼š
   - ModelService
   - TemplateService
   - WorkflowService
   - AgentService

---

## ğŸ“Š å­—æ®µå†—ä½™åˆ†æ

### âœ… åˆç†çš„å†—ä½™å­—æ®µï¼ˆæ¨èä¿ç•™ï¼‰

1. **ç»Ÿè®¡å­—æ®µå†—ä½™**ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰ï¼š
   - `workflows.execution_count` - é¿å…æ¯æ¬¡ COUNT æŸ¥è¯¢
   - `knowledge_bases.document_count` - è‡ªåŠ¨è§¦å‘å™¨ç»´æŠ¤
   - `prompt_templates.usage_count` - çƒ­é—¨æ¨¡æ¿æ’åº

2. **ç¼“å­˜å­—æ®µå†—ä½™**ï¼ˆå‡å°‘å…³è”æŸ¥è¯¢ï¼‰ï¼š
   - `prompt_templates.current_version_id` - å¿«é€Ÿè·å–æœ€æ–°ç‰ˆæœ¬
   - `tenant_configs.default_model` - é¿å…æ¯æ¬¡æŸ¥è¯¢ models è¡¨

### âŒ ä¸å¿…è¦çš„å†—ä½™ï¼ˆå»ºè®®åˆ é™¤ï¼‰

1. **å¯è®¡ç®—çš„å­—æ®µ**ï¼š
   - ~~`workflows.success_count/failure_count`~~ â†’ å¯é€šè¿‡ COUNT(status) è®¡ç®—
   - å»ºè®®ï¼šä»…ä¿ç•™æ€»æ‰§è¡Œæ•°ï¼ŒæˆåŠŸ/å¤±è´¥æ•°é€šè¿‡æŸ¥è¯¢è®¡ç®—

2. **é‡å¤çš„é…ç½®**ï¼š
   - å¦‚æœ `tenant_configs` å’Œ `agent_configs` éƒ½æœ‰ `temperature`ï¼Œéœ€è¦æ˜ç¡®ä¼˜å…ˆçº§

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç¬¬ 1 æ­¥ï¼šåˆ›å»ºç¼ºå¤±æ¨¡å‹ï¼ˆ2 å¤©ï¼‰
- [ ] åˆ›å»º `backend/internal/models/` æ¨¡å—
- [ ] åˆ›å»º `backend/internal/template/` æ¨¡å—
- [ ] åˆ›å»º `backend/internal/workflow/` æ¨¡å—
- [ ] åˆ›å»º `backend/internal/agent/` æ¨¡å—

### ç¬¬ 2 æ­¥ï¼šå®Œå–„ç°æœ‰æ¨¡å‹ï¼ˆ1 å¤©ï¼‰
- [ ] æ›´æ–° Permission æ¨¡å‹
- [ ] æ›´æ–° UserRole/RolePermission æ¨¡å‹
- [ ] é‡æ„ TenantConfig æ¨¡å‹
- [ ] æ‰©å±• TenantQuota æ¨¡å‹

### ç¬¬ 3 æ­¥ï¼šåˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆ1 å¤©ï¼‰
- [ ] 0005_create_models_tables.sql
- [ ] 0006_create_template_tables.sql
- [ ] 0007_create_workflow_tables.sql
- [ ] 0008_create_agent_tables.sql
- [ ] 0009_update_tenant_config.sql

### ç¬¬ 4 æ­¥ï¼šç¼–å†™ Service å±‚ï¼ˆ3 å¤©ï¼‰
- [ ] ModelService
- [ ] TemplateService
- [ ] WorkflowService
- [ ] AgentService

---

## ğŸ“ æœ€ç»ˆå»ºè®®

### æ˜¯å¦éœ€è¦ä¸€æ­¥åˆ°ä½å®Œå–„ï¼Ÿ

**å»ºè®®ï¼šåˆ†é˜¶æ®µå®æ–½ï¼Œä¼˜å…ˆæ ¸å¿ƒåŠŸèƒ½**

**ç†ç”±**ï¼š
1. **ä»£ç åº“è§„æ¨¡**ï¼šä¸€æ¬¡æ€§æ·»åŠ  4 ä¸ªæ–°æ¨¡å—ï¼ˆ16+ ä¸ªæ–‡ä»¶ï¼‰é£é™©è¾ƒå¤§
2. **æµ‹è¯•è¦†ç›–**ï¼šéœ€è¦ä¸ºæ¯ä¸ªæ¨¡å—ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
3. **ä¸šåŠ¡ä¼˜å…ˆçº§**ï¼šWorkflow å’Œ Agent æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼ŒTemplate æ¬¡ä¹‹ï¼ŒModelCallLog å¯åç»­

**æ¨èé¡ºåº**ï¼š
1. **Phase 1**ï¼šWorkflow + Agent æ¨¡å‹ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
2. **Phase 2**ï¼šTemplate æ¨¡å‹ï¼ˆæ”¯æ’‘åŠŸèƒ½ï¼‰
3. **Phase 3**ï¼šModels æ¨¡å‹ï¼ˆç›‘æ§ç»Ÿè®¡ï¼‰
4. **Phase 4**ï¼šå®Œå–„ TenantConfig/Quotaï¼ˆè¿è¥åŠŸèƒ½ï¼‰

---

## âœ… éªŒæ”¶æ ‡å‡†

### æ¨¡å‹å®Œæ•´æ€§
- âœ… æ‰€æœ‰è¡¨éƒ½æœ‰å¯¹åº”çš„ Go æ¨¡å‹
- âœ… æ‰€æœ‰æ¨¡å‹éƒ½æœ‰ GORM æ ‡ç­¾
- âœ… æ‰€æœ‰å…³é”®è¡¨éƒ½æ”¯æŒè½¯åˆ é™¤
- âœ… æ‰€æœ‰æ¨¡å‹éƒ½æœ‰æ—¶é—´æˆ³

### æ•°æ®åº“ä¸€è‡´æ€§
- âœ… Go æ¨¡å‹ä¸æ•°æ®åº“è¡¨ç»“æ„ä¸€è‡´
- âœ… å­—æ®µç±»å‹åŒ¹é…ï¼ˆUUIDã€JSONBã€Decimalï¼‰
- âœ… ç´¢å¼•ç­–ç•¥å·²å®ç°
- âœ… å¤–é”®çº¦æŸå·²é…ç½®

### æ–‡æ¡£å®Œæ•´æ€§
- âœ… æ¯ä¸ªæ¨¡å—éƒ½æœ‰ README æ–‡æ¡£
- âœ… å­—æ®µå«ä¹‰æœ‰æ³¨é‡Š
- âœ… ä½¿ç”¨ç¤ºä¾‹å®Œæ•´

---

**æ€»è®¡éœ€è¡¥å……**ï¼š
- 4 ä¸ªæ–°æ¨¡å—ï¼ˆmodelsã€templateã€workflowã€agentï¼‰
- 9 ä¸ªæ–° Go æ¨¡å‹æ–‡ä»¶
- 4-5 ä¸ªæ•°æ®åº“è¿ç§»è„šæœ¬
- çº¦ 1500+ è¡Œä»£ç 

**é¢„è®¡å·¥æ—¶**ï¼š7-10 å¤©ï¼ˆå«æµ‹è¯•å’Œæ–‡æ¡£ï¼‰